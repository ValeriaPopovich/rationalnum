<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ ‚Äî –º–∏–Ω–∏‚Äë–∏–≥—Ä–∞</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Nunito:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#fff7fb; --card:#ffffffcc; --ink:#7a2052; --muted:#9c3a74; --accent:#ff91a4; --accent-2:#ffd7a8; --mint:#c9f2e9; --beige:#fff1e6; --good:#27ae60; --bad:#e74c3c; --shadow:0 10px 30px rgba(159,85,140,.15); --radius:22px; }
    *{box-sizing:border-box}
    body{margin:0;font-family:Poppins,Nunito,sans-serif;color:var(--ink);background:
      radial-gradient(1000px 600px at 0% 0%, #ffe7f0 0%, transparent 55%),
      radial-gradient(900px 600px at 100% 0%, #e9fff7 0%, transparent 55%),
      var(--bg);
    }
    .wrap{max-width:980px;margin:auto;padding:20px;background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow)}
    header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
    h1{font-size:clamp(20px,4vw,32px);margin:0}
    .controls{display:flex;gap:10px}
    button{border:none;cursor:pointer;border-radius:14px;padding:10px 16px;font-weight:700;box-shadow:var(--shadow);background:linear-gradient(180deg,#ffd1dc,#ffabba);} button.ghost{background:#fff}
    .screen{margin-top:20px;display:grid;gap:20px}
    .card{background:#fff;border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)}
    .problem{font-size:clamp(20px,5vw,36px);font-weight:800;text-align:center}
    .chip{padding:8px 12px;border-radius:999px;background:#ffe9f0;font-weight:800;box-shadow:var(--shadow)}
    .opt{padding:10px 14px;border-radius:12px;background:#fff;box-shadow:var(--shadow);cursor:pointer}
    .toast{position:fixed;bottom:-80px;left:50%;transform:translateX(-50%);background:#fff;padding:10px 16px;border-radius:12px;box-shadow:var(--shadow);transition:all .4s ease}
    .toast.show{bottom:20px}
    .level-ind{width:100%;height:10px;background:#f7e8f0;border-radius:999px;overflow:hidden;margin-top:10px}
    .level-fill{height:100%;width:0;background:linear-gradient(90deg,#ff9fb2,#ffd29f,#b7f0e6);transition:.3s}
    .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    .dzone{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏</h1>
      <div class="controls">
        <button id="btnRestart" class="ghost">‚Üª –°–±—Ä–æ—Å</button>
        <button id="btnNext">–î–∞–ª—å—à–µ ‚Üí</button>
        <button id="btnSub">‚òÖ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
      </div>
    </header>
    <div class="level-ind"><div class="level-fill" id="levelFill"></div></div>
    <section id="screen" class="screen"></section>
    <div id="toast" class="toast">–£–º–Ω–∏—á–∫–∞! üåü</div>
  </div>

  <script>
    // ===== Helpers =====
    const $ = s => document.querySelector(s);
    const rnd = (a,b) => Math.floor(Math.random()*(b-a+1))+a;
    const pick = a => a[Math.floor(Math.random()*a.length)];
    const showToast = (t,g=true) => { const el=$('#toast'); el.textContent=t; el.style.background=g?'#fff':'#ffe5ea'; el.classList.add('show'); setTimeout(()=>el.classList.remove('show'),1100); };

    const levelFill=$('#levelFill');
    const CHANNEL_URL='https://t.me/lera_easy_math';

    const LEVELS=[
      {kind:'mcq-plus', name:'–°–ª–æ–∂–µ–Ω–∏–µ'},
      {kind:'transform-minus', name:'–ù–∞–π–¥–∏ –ø—Ä–æ–ø—É—Å–∫'},
      {kind:'sign-table', name:'–£–º–Ω–æ–∂–µ–Ω–∏–µ (–∑–Ω–∞–∫–∏)'},
      {kind:'match', name:'–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ'},
      {kind:'drag-sign-div', name:'–î–µ–ª–µ–Ω–∏–µ (–∑–Ω–∞–∫+–≤–µ–ª–∏—á–∏–Ω–∞)'},
      {kind:'fractions', name:'–î—Ä–æ–±–∏: —Ü–µ–ª—ã–π –æ—Ç–≤–µ—Ç'}
    ];

    let state={levelIndex:0,score:0};

    $('#btnRestart').onclick=()=>{state={levelIndex:0,score:0};renderLevel();progress()};
    $('#btnNext').onclick=()=>{if(state.levelIndex<LEVELS.length-1){state.levelIndex++;renderLevel();progress()}else showFinal()};
    $('#btnSub').onclick=()=>window.open(CHANNEL_URL,'_blank');

    const autoAdvance=(d=900)=>setTimeout(()=>$('#btnNext').click(),d);
    const progress=()=>{ levelFill.style.width=`${state.levelIndex/(LEVELS.length-1)*100}%`; };

    const screen=$('#screen');

    const fmt = (n)=> (Object.is(n,-0)||n===0)? '0' : n.toString();
    const withSign = (op,b)=> ((op==='+'||op==='‚àí') && b<0) ? `${op} (${fmt(b)})` : `${op} ${fmt(b)}`;
    const createHint = (text)=>{ const w=document.createElement('div'); w.className='card'; w.style.display='none'; w.innerHTML=`<div class="chip" style="background:#fff9f2">${text}</div>`; return w; };

    function renderLevel(){
      screen.innerHTML='';
      const {kind} = LEVELS[state.levelIndex];
      if(kind==='mcq-plus') renderPlus();
      if(kind==='transform-minus') renderMinus();
      if(kind==='sign-table') renderTimes();
      if(kind==='match') renderMatch();
      if(kind==='drag-sign-div') renderDivide();
      if(kind==='fractions') renderFractions();
    }

    // ===== Level 1: –°–ª–æ–∂–µ–Ω–∏–µ (–≤–≤–æ–¥) =====
    function makeAddProblem(){ let a=rnd(-15,15), b=rnd(-15,15); while(a===0 && b===0){ a=rnd(-15,15); b=rnd(-15,15);} return {expr:`${fmt(a)} ${withSign('+',b)}`, ans:a+b}; }
    function renderPlus(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`<div class="problem" id="p1"></div>
      <div class="dzone">
        <input id="ansAdd" inputmode="numeric" class="chip" style="background:#f2fffb" placeholder="–û—Ç–≤–µ—Ç"/>
        <button id="checkAdd">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button id="toggleH1" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
      </div>`; screen.appendChild(card);
      const hint=createHint('–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞–∫–∏ ‚Äî —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –º–æ–¥—É–ª–∏ –∏ —Å—Ç–∞–≤–∏–º —Ç–æ—Ç –∂–µ –∑–Ω–∞–∫. –†–∞–∑–Ω—ã–µ ‚Äî –≤—ã—á–∏—Ç–∞–µ–º –º–µ–Ω—å—à–∏–π –º–æ–¥—É–ª—å –∏–∑ –±–æ–ª—å—à–µ–≥–æ –∏ —Å—Ç–∞–≤–∏–º –∑–Ω–∞–∫ –±–æ–ª—å—à–µ–≥–æ –ø–æ –º–æ–¥—É–ª—é.'); screen.appendChild(hint);
      card.querySelector('#toggleH1').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };
      let q=0, need=5, cur; const pEl=card.querySelector('#p1'); const input=card.querySelector('#ansAdd'); const btn=card.querySelector('#checkAdd');
      function nextQ(){ if(q>=need){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); return; } cur=makeAddProblem(); pEl.textContent=cur.expr; input.value=''; input.focus(); }
      btn.onclick=()=>{ const val=Number(input.value.replace(',','.')); if(val===cur.ans){ showToast('–ü—Ä–∞–≤–∏–ª—å–Ω–æ! üíñ'); q++; state.score+=10; nextQ(); } else { showToast('–ï—â—ë —Ä–∞–∑–æ–∫!', false);} };
      input.addEventListener('keydown',e=>{ if(e.key==='Enter') btn.click(); });
      nextQ();
    }

    // ===== Level 2: –ù–∞–π–¥–∏ –ø—Ä–æ–ø—É—Å–∫ =====
    function renderMinus(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`<div class="problem" id="expr2"></div>
      <div class="dzone">
        <input id="ansMiss" inputmode="numeric" class="chip" style="background:#f2fffb" placeholder="–ß–∏—Å–ª–æ –≤ –ø—É—Å—Ç–æ–º –º–µ—Å—Ç–µ"/>
        <button id="checkMiss">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button id="toggleH2" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
      </div>`; screen.appendChild(card);
      const hint=createHint('–ü–µ—Ä–µ–Ω–æ—Å —á–µ—Ä–µ–∑ = –º–µ–Ω—è–µ—Ç –∑–Ω–∞–∫. a ‚àí b = a + (‚àíb).'); screen.appendChild(hint); card.querySelector('#toggleH2').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };

      const exprEl=card.querySelector('#expr2'); const input=card.querySelector('#ansMiss'); const btn=card.querySelector('#checkMiss');
      let step=0, need=5, cur=null, lastExpr='';
      function makeMissingProblem(){ let pr; do{ const t=pick(['a-b','x-b','a+x']); let a=rnd(-12,12), b=rnd(-12,12); while(a===0&&b===0){ a=rnd(-12,12); b=rnd(-12,12);} if(t==='a-b'){ const c=a-b; pr={expr:`${fmt(a)} ‚àí ‚ñ° = ${fmt(c)}`, ans:b}; } else if(t==='x-b'){ const c=a-b; pr={expr:`‚ñ° ‚àí ${fmt(b)} = ${fmt(c)}`, ans:a}; } else { const c2=a+b; pr={expr:`${fmt(a)} + ‚ñ° = ${fmt(c2)}`, ans:b}; } } while(pr.expr===lastExpr); lastExpr=pr.expr; return pr; }
      function init(){ cur=makeMissingProblem(); exprEl.textContent=cur.expr; input.value=''; input.focus(); }
      btn.onclick=()=>{ const val=Number(input.value.replace(',','.')); if(val===cur.ans){ showToast('–ï—Å—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç! ‚úÖ'); step++; state.score+=12; if(step>=need){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); } else { init(); } } else { showToast('–ú–∏–º–æ, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë', false); } };
      input.addEventListener('keydown',e=>{ if(e.key==='Enter') btn.click(); });
      init();
    }

    // ===== Level 3: –£–º–Ω–æ–∂–µ–Ω–∏–µ (–∑–Ω–∞–∫) =====
    function renderTimes(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`<div class="grid" id="signGrid"></div>
      <div style="text-align:center"><button id="toggleH3" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button></div>`; screen.appendChild(card);
      const hint=createHint('–û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞–∫–∏ ( +√ó+ , ‚àí√ó‚àí ) –¥–∞—é—Ç –ø–ª—é—Å. –†–∞–∑–Ω—ã–µ ( +√ó‚àí , ‚àí√ó+ ) ‚Äî –º–∏–Ω—É—Å.'); screen.appendChild(hint); card.querySelector('#toggleH3').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };

      const grid=card.querySelector('#signGrid'); let solved=0; const items=8; const combos=['++','+-','-+','--'];
      function makeRow(pair){ const A=pair[0]==='+'?'+':'‚àí'; const B=pair[1]==='+'?'+':'‚àí'; const ask=`${A} √ó ${B}`; const ans=(A===B)? '+':'‚àí'; const row=document.createElement('div'); row.className='card'; row.style.padding='12px'; row.innerHTML=`<div class="problem" style="font-size:clamp(18px,4vw,28px)">${ask} = ?</div><div class="dzone"><button class="opt">+</button><button class="opt">‚àí</button></div>`; row.querySelectorAll('.opt').forEach(b=>{ b.onclick=()=>{ if(b.textContent===ans){ showToast('–í–µ—Ä–Ω–æ! üåø'); solved++; row.style.opacity=.55; row.querySelectorAll('button').forEach(x=>x.disabled=true); state.score+=6; if(solved>=items){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); } } else { showToast('–ù–µ—Ç, –ø–æ—Å–º–æ—Ç—Ä–∏ –ø—Ä–∞–≤–∏–ª–æ', false); } }; }); return row; }
      function spawn(){ grid.innerHTML=''; const out=[]; let last=null; while(out.length<items){ const pack=combos.slice().sort(()=>Math.random()-.5); for(const p of pack){ if(out.length>=items) break; if(p!==last){ out.push(p); last=p; } } } out.forEach(p=> grid.appendChild(makeRow(p))); }
      spawn();
    }

    // ===== Level 4: –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ =====
    function renderMatch(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`
        <div class="level-ind" style="height:12px"><div class="level-fill" id="pairBar" style="width:0%"></div></div>
        <div class="card" id="left" style="margin-top:10px"></div>
        <div class="card" id="right" style="margin-top:10px"></div>
        <div style="text-align:center"><button id="toggleHM" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button></div>`; screen.appendChild(card);
      const hint=createHint('–ü–µ—Ä–µ—Ç–∞—â–∏ —á–∏—Å–ª–æ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É –≤—ã—Ä–∞–∂–µ–Ω–∏—é. –ü–æ—Å–ª–µ —É–¥–∞—á–Ω–æ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Ñ–∏—à–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç.'); screen.appendChild(hint); card.querySelector('#toggleHM').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };

      const left=card.querySelector('#left'); const right=card.querySelector('#right'); const bar=card.querySelector('#pairBar');
      function makePair(){ const t=pick(['add','sub','mul','div']); if(t==='add'){ let a=rnd(-9,9),b=rnd(-9,9); while(a===0&&b===0){ a=rnd(-9,9); b=rnd(-9,9);} return {expr:`${fmt(a)} ${withSign('+',b)}`, val:a+b}; } if(t==='sub'){ let a=rnd(-9,9), b=rnd(-9,9); return {expr:`${fmt(a)} ‚àí ${fmt(b)}`, val:a-b}; } if(t==='mul'){ let a=rnd(-9,9), b=rnd(-9,9); return {expr:`${fmt(a)} √ó ${fmt(b)}`, val:a*b}; } let d=rnd(1,9), q=rnd(1,9); let a=d*q, b=d; if(Math.random()<.5) a=-a; if(Math.random()<.5) b=-b; return {expr:`${fmt(a)} √∑ ${fmt(b)}`, val:a/b}; }
      const pairs = Array.from({length:6}, makePair);
      const answers = pairs.map((p,i)=>({val:p.val, id:i})).sort(()=>Math.random()-.5);
      pairs.forEach((p,i)=>{ const row=document.createElement('div'); row.className='dzone'; row.style.justifyContent='space-between'; row.style.margin='6px 0'; row.innerHTML=`<div class="problem" style="font-size:clamp(18px,4vw,28px)">${p.expr} = </div><div class="chip" style="background:#fff9f2;min-width:64px;text-align:center" data-target="${i}">?</div>`; left.appendChild(row); });
      answers.forEach(({val,id})=>{ const chip=document.createElement('div'); chip.className='chip draggable'; chip.setAttribute('draggable','true'); chip.dataset.id=id; chip.textContent=val.toString(); chip.style.margin='6px'; chip.style.background='#e8fff7'; chip.addEventListener('dragstart',e=>{ e.dataTransfer.setData('text/plain', chip.dataset.id); }); right.appendChild(chip); });
      let solved=0; const total=pairs.length;
      left.querySelectorAll('[data-target]').forEach(slot=>{
        slot.addEventListener('dragover', e=>e.preventDefault());
        slot.addEventListener('drop', e=>{ e.preventDefault(); const id=e.dataTransfer.getData('text/plain'); if(slot.dataset.filled) return; if(slot.dataset.target===id){ const chip = right.querySelector(`.draggable[data-id="${id}"]`); if(chip){ slot.textContent=chip.textContent; chip.remove(); slot.dataset.filled='1'; solved++; bar.style.width=(solved/total*100)+'%'; if(solved>=total){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); } } } else { showToast('–≠—Ç–æ –∫ –¥—Ä—É–≥–æ–π –ø–∞—Ä–µ', false); } });
      });
    }

    // ===== Level 5: –î–µ–ª–µ–Ω–∏–µ (–∑–Ω–∞–∫+–≤–µ–ª–∏—á–∏–Ω–∞) =====
    function makeDivProblem(){ let b=rnd(1,9); let a=b*rnd(1,9); if(Math.random()<.5) a=-a; if(Math.random()<.5) b=-b; return { a,b, expr:`${fmt(a)} √∑ ${fmt(b)}`, sign:(Math.sign(a)===Math.sign(b))?'+':'‚àí', mag:Math.abs(a)/Math.abs(b) }; }
    function renderDivide(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`
        <div class="level-ind" style="height:12px"><div class="level-fill" id="innerBar" style="width:0%"></div></div>
        <div class="problem" id="divExpr" style="margin-top:10px"></div>
        <div class="dzone" style="gap:14px;justify-content:center">
          <div class="draggable chip" draggable="true" data-sym="+">+</div>
          <div class="draggable chip" draggable="true" data-sym="‚àí">‚àí</div>
          <div class="chip" id="signSlot" style="min-width:60px;background:#fff9f2">?</div>
          <input id="mag" inputmode="numeric" class="chip" style="background:#fff9f2" placeholder="–í–µ–ª–∏—á–∏–Ω–∞"/>
          <button id="checkDiv">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        </div>
        <div style="text-align:center"><button id="toggleH4" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button></div>`; screen.appendChild(card);
      const hint=createHint('–ó–Ω–∞–∫ –∫–∞–∫ –≤ —É–º–Ω–æ–∂–µ–Ω–∏–∏. –ü–æ—Ç–æ–º –¥–µ–ª–∏–º –º–æ–¥—É–ª–∏: |a| √∑ |b|.'); screen.appendChild(hint); card.querySelector('#toggleH4').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };

      const innerBar=card.querySelector('#innerBar'); const exprEl=card.querySelector('#divExpr'); const signSlot=card.querySelector('#signSlot'); const magInput=card.querySelector('#mag'); const btn=card.querySelector('#checkDiv');
      let done=0, need=6, cur=null;
      function init(){ cur=makeDivProblem(); exprEl.textContent=cur.expr; signSlot.textContent='?'; signSlot.dataset.value=''; magInput.value=''; innerBar.style.width=(done/need*100)+'%'; }
      card.querySelectorAll('[draggable]').forEach(el=>{ el.addEventListener('dragstart', e=>{ e.dataTransfer.setData('text/plain', el.dataset.sym); }); });
      signSlot.addEventListener('dragover', e=>e.preventDefault());
      signSlot.addEventListener('drop', e=>{ e.preventDefault(); const s=e.dataTransfer.getData('text/plain'); signSlot.textContent=s; signSlot.dataset.value=s; });
      btn.onclick=()=>{ const okSign=(signSlot.dataset.value===cur.sign); const val=Number(magInput.value.replace(',','.')); if(okSign && val===cur.mag){ showToast('–û—Ç–ª–∏—á–Ω–æ! üéâ'); done++; state.score+=10; if(done>=need){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); } else { init(); } innerBar.style.width=(done/need*100)+'%'; } else if(!okSign){ showToast('–ó–Ω–∞–∫ –Ω–µ —Ç–æ—Ç', false); } else { showToast('–ü—Ä–æ–≤–µ—Ä—å –¥–µ–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π', false); } };
      init();
    }

    // ===== Level 6: –î—Ä–æ–±–∏/–¥–µ—Å—è—Ç–∏—á–Ω—ã–µ ‚Äî —Ç–æ–ª—å–∫–æ –¶–ï–õ–´–ï –æ—Ç–≤–µ—Ç—ã =====
    function gcd(a,b){ a=Math.abs(a); b=Math.abs(b); while(b){ [a,b]=[b,a%b]; } return a||1; }
    function fracToStr(n,d){ const s = n<0?'‚àí':''; return `${s}${Math.abs(n)}/${d}`; }
    function makeIntFracTask(){
      const t = pick(['frac2int','dec2int','addFrac','subFrac']);
      if(t==='frac2int'){
        const d=rnd(2,9); const k=rnd(-5,5)||1; const n=d*k; return {expr:`${fracToStr(n,d)} = ?`, ans:k};
      }
      if(t==='dec2int'){
        const k=rnd(-9,9); const s=`${k}.0`.replace('-','‚àí'); return {expr:`${s} = ?`, ans:k};
      }
      const d=rnd(2,9);
      const m = rnd(-6,6);
      const n1 = rnd(-9,9);
      const opAdd = (t==='addFrac');
      const n2 = opAdd ? (m*d - n1) : (n1 - m*d); // —Ñ–æ—Ä–º—É–ª—ã –ø–æ–¥–æ–±—Ä–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç –±—ã–ª m
      return {expr:`${fracToStr(n1,d)} ${opAdd?'+':'‚àí'} ${fracToStr(n2,d)} = ?`, ans:m};
    }
    function renderFractions(){
      const card=document.createElement('div'); card.className='card';
      card.innerHTML=`<div class="problem" id="frExpr"></div>
      <div class="dzone"><input id="frAns" class="chip" placeholder="—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ"/>
      <button id="frCheck">–û–∫</button>
      <button id="toggleH5" class="ghost">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button></div>`; screen.appendChild(card);
      const hint=createHint('–í—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞–µ–º –¶–ï–õ–û–ï. –ü—Ä–∏–º–µ—Ä—ã: 6/3 ‚Üí 2, 3.0 ‚Üí 3, 5/8 + 3/8 ‚Üí 1.'); screen.appendChild(hint); card.querySelector('#toggleH5').onclick=()=>{ hint.style.display = hint.style.display==='none'?'block':'none'; };
      const exprEl=card.querySelector('#frExpr'); const input=card.querySelector('#frAns'); const btn=card.querySelector('#frCheck'); let done=0, need=6, cur;
      function ask(){ cur=makeIntFracTask(); exprEl.textContent=cur.expr; input.value=''; input.focus(); }
      btn.onclick=()=>{ const val = Number(input.value.replace(',','.')); if(!Number.isInteger(val)){ showToast('–ù—É–∂–Ω–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ', false); return; } if(val===cur.ans){ showToast('–°—É–ø–µ—Ä! ‚úÖ'); done++; state.score+=14; if(done>=need){ showToast('–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! ‚ú®'); autoAdvance(); } else { ask(); } } else { showToast('–ù–µ —Å–æ–≤–ø–∞–ª–æ', false); } };
      input.addEventListener('keydown',e=>{ if(e.key==='Enter') btn.click(); });
      ask();
    }

    function showFinal(){ screen.innerHTML='<div class="card"><div class="problem">–§–∏–Ω–∏—à! –û—á–∫–∏: '+state.score+'</div></div>'; }

    // start
    renderLevel(); progress();
  </script>
</body>
</html>
